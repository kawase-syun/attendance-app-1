# セットアップガイド

このガイドでは、出退勤打刻アプリを実際に動作させるための詳細な手順を説明します。

## 📋 目次

1. [Googleスプレッドシートの作成](#1-googleスプレッドシートの作成)
2. [Google Apps Scriptの設定](#2-google-apps-scriptの設定)
3. [LINE Messaging APIの設定確認](#3-line-messaging-apiの設定確認)
4. [フロントエンドの設定](#4-フロントエンドの設定)
5. [PWAアイコンの作成](#5-pwaアイコンの作成)
6. [GitHubへのアップロード](#6-githubへのアップロード)
7. [動作確認](#7-動作確認)

---

## 1. Googleスプレッドシートの作成

### 手順

1. **新しいスプレッドシートを作成**
   - Google Driveにアクセス
   - 「新規」→「Googleスプレッドシート」→「空白のスプレッドシート」
   - ファイル名を「出退勤打刻記録」などに変更

2. **シート1: 研修生マスタ**
   - デフォルトの「Sheet1」の名前を「研修生マスタ」に変更
   - 以下のデータを入力：

   | A列（研修生ID） | B列（氏名） | C列（ステータス） |
   |----------------|-----------|-----------------|
   | 研修生ID       | 氏名      | ステータス       |
   | user01         | あなたの名前 | 進行中          |

3. **シート2: 打刻記録**
   - 新しいシートを追加（下部の「+」ボタン）
   - シート名を「打刻記録」に変更
   - 以下の見出しを入力：

   | A列 | B列 | C列 | D列 | E列 | F列 |
   |-----|-----|-----|-----|-----|-----|
   | 日付 | 研修生ID | 氏名 | 出勤時刻 | 退勤時刻 | 勤務時間 |

4. **シート3: 課題完了記録**
   - 新しいシートを追加
   - シート名を「課題完了記録」に変更
   - 以下の見出しを入力：

   | A列 | B列 | C列 | D列 | E列 |
   |-----|-----|-----|-----|-----|
   | 完了日時 | 研修生ID | 氏名 | アプリURL | 判定 |

---

## 2. Google Apps Scriptの設定

### 手順

1. **Apps Scriptエディタを開く**
   - スプレッドシートで「拡張機能」→「Apps Script」をクリック

2. **コードを貼り付け**
   - デフォルトの `function myFunction()` を全て削除
   - `Code.gs` ファイルの内容を全てコピー＆ペースト

3. **スクリプトプロパティを設定**
   - 左サイドバーの「プロジェクトの設定」（歯車アイコン）をクリック
   - 「スクリプト プロパティ」セクションまでスクロール
   - 「スクリプト プロパティを追加」をクリック
   - 以下の2つのプロパティを追加：

   **プロパティ1:**
   - プロパティ: `LINE_CHANNEL_ACCESS_TOKEN`
   - 値: `YOZ7UftinQaO3OyBDaloYu4cXzhYtLzmqBzAGNvCIJRg7h+DoqsX0n6OXdfOFZ9vI7/+VIOKgdWLHJ6yBmeAi6kPqz4+FZ3vpHQTBEAQSHA81c9tQLH/8oP8UUyRpnHxvmJ0QlaAjZWiraJeO38tBgdB04t89/1O/w1cDnyilFU=`

   **プロパティ2:**
   - プロパティ: `LINE_GROUP_ID`
   - 値: `C5a5b36e27a78ed6cfbb74839a8a9d04e`

   - 「スクリプト プロパティを保存」をクリック

4. **シートの初期セットアップ（オプション）**
   - エディタに戻る
   - 関数ドロップダウンから `setupSheets` を選択
   - 「実行」ボタンをクリック
   - 初回実行時は権限の承認が必要
     - 「権限を確認」→ Googleアカウントを選択
     - 「詳細」→「(プロジェクト名)に移動」
     - 「許可」をクリック

5. **Webアプリとしてデプロイ**
   - 右上の「デプロイ」→「新しいデプロイ」をクリック
   - 「種類の選択」で歯車アイコン→「ウェブアプリ」を選択
   - 設定：
     - 説明: `出退勤打刻アプリAPI v1`
     - 次のユーザーとして実行: **自分**
     - アクセスできるユーザー: **全員**
   - 「デプロイ」をクリック
   - **WebアプリのURL**をコピーして保存（後で使用）
     - 例: `https://script.google.com/macros/s/AKfycby.../exec`

---

## 3. LINE Messaging APIの設定確認

すでに提供されている情報を確認：

- **チャネルアクセストークン**:
  ```
  YOZ7UftinQaO3OyBDaloYu4cXzhYtLzmqBzAGNvCIJRg7h+DoqsX0n6OXdfOFZ9vI7/+VIOKgdWLHJ6yBmeAi6kPqz4+FZ3vpHQTBEAQSHA81c9tQLH/8oP8UUyRpnHxvmJ0QlaAjZWiraJeO38tBgdB04t89/1O/w1cDnyilFU=
  ```

- **グループID**:
  ```
  C5a5b36e27a78ed6cfbb74839a8a9d04e
  ```

これらは既にGoogle Apps Scriptのスクリプトプロパティに設定済みです。

---

## 4. フロントエンドの設定

### 手順

1. **app.js を編集**
   - `app.js` ファイルを開く
   - 冒頭の `CONFIG` オブジェクトを編集：

   ```javascript
   const CONFIG = {
       // ステップ2でコピーしたGASのWebアプリURLを貼り付け
       GAS_URL: 'https://script.google.com/macros/s/AKfycby.../exec',

       // あなたの研修生ID
       USER_ID: 'user01',

       // あなたの名前（研修生マスタと同じ）
       USER_NAME: 'あなたの名前'
   };
   ```

2. **保存**
   - ファイルを保存

---

## 5. PWAアイコンの作成

PWAとしてスマホにインストールするには、アイコン画像が必要です。

### オプション1: オンラインツールで作成

1. **Canva（無料）を使用**
   - https://www.canva.com/ にアクセス
   - 「カスタムサイズ」で 512x512px を指定
   - 緑色の背景に時計またはカレンダーのアイコンを配置
   - PNGでダウンロード

2. **リサイズ**
   - 512x512px の画像を `icon-512.png` として保存
   - 192x192px にリサイズして `icon-192.png` として保存

### オプション2: プレースホルダーを使用

テスト用に簡易的なアイコンを作成：

1. **オンラインジェネレーター**
   - https://www.favicon-generator.org/ などを使用
   - 緑色の背景に「出」または「⏰」を配置
   - 512x512 と 192x192 を生成

2. **ファイル名を変更**
   - ダウンロードしたファイルを `icon-512.png` と `icon-192.png` にリネーム

3. **プロジェクトフォルダに配置**
   - プロジェクトのルートディレクトリに配置

---

## 6. GitHubへのアップロード

### 手順

1. **GitHubリポジトリを作成**
   - GitHubにログイン
   - 右上の「+」→「New repository」
   - Repository name: `attendance-app`
   - Public を選択
   - 「Create repository」をクリック

2. **ローカルのGit設定**
   ```bash
   git init
   git add .
   git commit -m "Initial commit: 出退勤打刻アプリ"
   git branch -M main
   git remote add origin https://github.com/あなたのユーザー名/attendance-app.git
   git push -u origin main
   ```

3. **GitHub Pagesを有効化**
   - リポジトリページで「Settings」タブをクリック
   - 左サイドバーの「Pages」をクリック
   - Source: 「Deploy from a branch」を選択
   - Branch: `main` / `/ (root)` を選択
   - 「Save」をクリック
   - 数分待つとURLが表示されます
     - 例: `https://あなたのユーザー名.github.io/attendance-app/`

---

## 7. 動作確認

### デスクトップでの確認

1. **ブラウザでアクセス**
   - GitHub PagesのURLにアクセス
   - アプリが正しく表示されることを確認

2. **出勤打刻テスト**
   - 「出勤打刻」ボタンをクリック
   - LINEグループに通知が届くことを確認
   - スプレッドシートに記録されることを確認

3. **退勤打刻テスト**
   - 「退勤打刻」ボタンをクリック
   - 勤務時間が計算されることを確認
   - LINEグループに通知が届くことを確認

### スマートフォンでの確認

1. **PWAインストール（iOS Safari）**
   - SafariでアプリのURLを開く
   - 下部の「共有」ボタン（↑）をタップ
   - 「ホーム画面に追加」をタップ
   - 「追加」をタップ

2. **PWAインストール（Android Chrome）**
   - ChromeでアプリのURLを開く
   - 右上のメニュー（⋮）→「ホーム画面に追加」
   - 「追加」をタップ

3. **動作確認**
   - ホーム画面のアイコンからアプリを起動
   - ネイティブアプリのように動作することを確認

---

## 🎉 課題完了

すべての動作確認が完了したら：

1. アプリ内の「課題完了報告」ボタンをタップ
2. 管理者のLINEグループに通知が送信されます
3. スプレッドシートの「課題完了記録」シートに記録されます
4. 管理者による確認後、合格判定が行われます

---

## トラブルシューティング

### エラー: "GAS_URL is not defined"
- `app.js` の `CONFIG.GAS_URL` が正しく設定されているか確認
- GASのWebアプリURLを正しくコピーしたか確認

### LINEに通知が届かない
- GASのスクリプトプロパティが正しく設定されているか確認
- LINE APIのアクセストークンが有効か確認
- GASの実行ログでエラーを確認

### スプレッドシートに記録されない
- GASのデプロイ設定で「アクセスできるユーザー: 全員」になっているか確認
- ブラウザのコンソールでエラーを確認（F12キー）

### PWAがインストールできない
- HTTPSでアクセスしているか確認（GitHub Pagesは自動的にHTTPS）
- `manifest.json` が正しく配置されているか確認
- アイコンファイル（icon-192.png, icon-512.png）が存在するか確認

---

## サポート

問題が解決しない場合は、管理者に以下の情報を添えて連絡してください：

- エラーメッセージのスクリーンショット
- ブラウザのコンソールログ（F12キーで表示）
- GASの実行ログ
- 実施済みの手順

頑張ってください！ 💪
